var We=Object.defineProperty;var fe=t=>{throw TypeError(t)};var Ge=(t,r,u)=>r in t?We(t,r,{enumerable:!0,configurable:!0,writable:!0,value:u}):t[r]=u;var c=(t,r,u)=>Ge(t,typeof r!="symbol"?r+"":r,u),me=(t,r,u)=>r.has(t)||fe("Cannot "+u);var v=(t,r,u)=>(me(t,r,"read from private field"),u?u.call(t):r.get(t)),K=(t,r,u)=>r.has(t)?fe("Cannot add the same private member more than once"):r instanceof WeakSet?r.add(t):r.set(t,u),Z=(t,r,u,d)=>(me(t,r,"write to private field"),d?d.call(t,u):r.set(t,u),u);import{U as Ue,O as Ye,v as G,e as Xe,c as Ve,b as Ke}from"./Scene.D-IVrs4_.js";import{_ as $}from"./preload-helper.C1FmrZbK.js";import{g as Me}from"./controls.svelte.EJqBkrRw.js";import{g as de}from"./globalState.svelte.CHPqU7Zl.js";const ze=(t,r,u)=>{const d=t[r];return d?typeof d=="function"?d():Promise.resolve(d):new Promise((m,l)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(l.bind(null,new Error("Unknown variable dynamic import: "+r+(r.split("/").length!==u?". Note that variables only represent file names one level deep.":""))))})};var Pe={},J={},O={},ee={},he;function D(){if(he)return ee;he=1,Object.defineProperty(ee,"__esModule",{value:!0}),ee.toFloatOrNull=ee.toIntOrNull=void 0,String.prototype.extract=function(u,d){try{const m=this.substring(u-1,d).trim();return m.isEmpty()?null:m}catch(m){return console.warn(m),null}},String.prototype.isEmpty=function(){return!this||!this.length},String.prototype.isBlank=function(){return!this||!this.trim().length};function t(u){if(u){const d=parseInt(u);return isNaN(d)?null:d}return null}ee.toIntOrNull=t;function r(u){if(u){const d=parseFloat(u);return isNaN(d)?null:d}return null}return ee.toFloatOrNull=r,ee}var te={},Se;function Y(){if(Se)return te;Se=1,Object.defineProperty(te,"__esModule",{value:!0}),te.SectionParser=te.AbstractParser=void 0;class t{constructor(){c(this,"lines",[])}collect(d){if(Array.isArray(d))for(const m of d)this.match(m)&&this.lines.push(m);else this.match(d)&&this.lines.push(d)}parse(){const d=this._parse();if(this.validate(d))return d;throw Error("validate error")}validate(d){return!0}}te.AbstractParser=t;class r{collect(d){if(Array.isArray(d))for(const m of d)for(const l of this.parsers())l.collect(m);else for(const m of this.parsers())m.collect(d)}}return te.SectionParser=r,te}var pe;function Te(){if(pe)return O;pe=1,Object.defineProperty(O,"__esModule",{value:!0}),O.TitleSectionParser=O.Remark470Parser=O.Remark465Parser=O.Remark350Parser=O.Remark4Parser=O.RemarkParser=O.SprsdeParser=O.RevdatParser=O.AuthorParser=O.MdltypParser=O.NummdlParser=O.ExpdtaParser=O.KeywdsParser=O.SourceParser=O.CompndParser=O.CaveatParser=O.SplitParser=O.TitleParser=O.ObslteParser=O.HeaderParser=O.Biomt=void 0,D();const t=Y(),r=D();class u{constructor(s,N,y,g,S,E){c(this,"recordName");c(this,"serial");c(this,"Mn1");c(this,"Mn2");c(this,"Mn3");c(this,"Vn");this.recordName=s,this.serial=N,this.Mn1=y,this.Mn2=g,this.Mn3=S,this.Vn=E}toPoint4D(){return[this.Mn1,this.Mn2,this.Mn3,this.Vn]}}O.Biomt=u;class d extends t.AbstractParser{match(s){return s.startsWith("HEADER")}_parse(){const s={classification:null,depDate:null,idCode:null};if(this.lines.length==0)return s;const N=this.lines[0],y=N.extract(11,50),g=N.extract(51,59),S=N.extract(63,66);return{...s,classification:y,depDate:g,idCode:S}}}O.HeaderParser=d;class m extends t.AbstractParser{match(s){return s.startsWith("OBSLTE")}_parse(){return this.lines.map(s=>{const N=s.extract(12,20),y=s.extract(22,25),g=[s.extract(32,35),s.extract(37,40),s.extract(42,45),s.extract(47,50),s.extract(52,55),s.extract(57,60),s.extract(62,65),s.extract(67,70),s.extract(72,75)];return{repDate:N,idCode:y,rIdCodes:g.filter(S=>S)}})}}O.ObslteParser=m;class l extends t.AbstractParser{match(s){return s.startsWith("TITLE ")}_parse(){const s=this.lines.map(N=>N.extract(11)).join(" ");return s.isBlank()?null:s}}O.TitleParser=l;class o extends t.AbstractParser{match(s){return s.startsWith("SPLIT ")}_parse(){return this.lines.flatMap(s=>[s.extract(12,15),s.extract(17,20),s.extract(22,25),s.extract(27,30),s.extract(32,35),s.extract(37,40),s.extract(42,45),s.extract(47,50),s.extract(52,55),s.extract(57,60),s.extract(62,65),s.extract(67,70),s.extract(72,75),s.extract(77,80)].filter(N=>N))}}O.SplitParser=o;class a extends t.AbstractParser{match(s){return s.startsWith("CAVEAT")}_parse(){return this.lines.flatMap(s=>{const N=s.extract(12,15),y=s.extract(20,79);return{idCode:N,comment:y}})}}O.CaveatParser=a;class i extends t.AbstractParser{isTokenBegin(s){const N=this.tokens();for(const y of N)if(s.startsWith(`${y}:`))return!0;return!1}_parse(){const s=this.lines.map(S=>S.extract(11,80)).filter(S=>S),N=[];for(const S of s){if(!S)continue;this.isTokenBegin(S)?N.push(S):N[N.length-1]+=S}const y=[];let g=null;for(const S of N){S.startsWith("MOL_ID:")&&(g!=null&&y.push(g),g={});const E=S.indexOf(":"),w=S.substring(0,E),T=S.substring(E+1).trim();g[w]=T.endsWith(";")?T.slice(0,-1):T}return g!=null&&y.push(g),y}}class P extends i{tokens(){return["MOL_ID","MOLECULE","CHAIN","FRAGMENT","SYNONYM","EC","ENGINEERED","MUTATION","OTHER_DETAILS"]}match(s){return s.startsWith("COMPND")}}O.CompndParser=P;class n extends i{tokens(){return["MOL_ID","SYNTHETIC","FRAGMENT","ORGANISM_SCIENTIFIC","ORGANISM_COMMON","ORGANISM_TAXID","STRAIN","VARIANT","CELL_LINE","ATCC","ORGAN","TISSUE","CELL","ORGANELLE","SECRETION","CELLULAR_LOCATION","PLASMID","GENE","EXPRESSION_SYSTEM","EXPRESSION_SYSTEM_COMMON","EXPRESSION_SYSTEM_TAXID","EXPRESSION_SYSTEM_STRAIN","EXPRESSION_SYSTEM_VARIANT","EXPRESSION_SYSTEM_CELL_LINE","EXPRESSION_SYSTEM_ATCC_NUMBER","EXPRESSION_SYSTEM_ORGAN","EXPRESSION_SYSTEM_TISSUE","EXPRESSION_SYSTEM_CELL","EXPRESSION_SYSTEM_ORGANELLE","EXPRESSION_SYSTEM_CELLULAR_LOCATION","EXPRESSION_SYSTEM_VECTOR_TYPE","EXPRESSION_SYSTEM_VECTOR","EXPRESSION_SYSTEM_PLASMID","EXPRESSION_SYSTEM_GENE","OTHER_DETAILS"]}match(s){return s.startsWith("SOURCE")}}O.SourceParser=n;class e extends t.AbstractParser{match(s){return s.startsWith("KEYWDS")}_parse(){return this.lines.map(s=>s.extract(11)).filter(s=>s).join("").split(",").map(s=>s.trim()).filter(s=>s)}}O.KeywdsParser=e;class f extends t.AbstractParser{match(s){return s.startsWith("EXPDTA")}_parse(){return this.lines.map(s=>s.extract(11)).filter(s=>s)}}O.ExpdtaParser=f;class h extends t.AbstractParser{match(s){return s.startsWith("NUMMDL")}_parse(){if(this.lines.length==0)return null;const N=this.lines[0].extract(11,14);return(0,r.toIntOrNull)(N)}}O.NummdlParser=h;class p extends t.AbstractParser{match(s){return s.startsWith("MDLTYP")}_parse(){return this.lines.map(s=>s.extract(11,48)).filter(s=>s)}}O.MdltypParser=p;class b extends t.AbstractParser{match(s){return s.startsWith("AUTHOR")}_parse(){return this.lines.map(s=>s.extract(11)).filter(s=>s).join("").split(",").map(s=>s.trim()).filter(s=>s)}}O.AuthorParser=b;class x extends t.AbstractParser{constructor(N=!0){super();c(this,"sortDesc");this.sortDesc=N}match(N){return N.startsWith("REVDAT")}_parse(){const N=this.lines.map(S=>{const E=S.extract(8,10),w=S.extract(14,22),T=S.extract(24,27),R=S.extract(32,32),L=[S.extract(40,45),S.extract(47,52),S.extract(54,59),S.extract(61,66)];return{modNum:(0,r.toIntOrNull)(E),modDate:w,modId:T,modType:R,records:L.filter(Q=>Q)}}),y=[];let g=null;for(const S of N){if(S.modNum==g){const E=y.length-1,{records:w,...T}={...y[E]};y[E]={...T,records:[...w,...S.records]}}else y.push(S);g=S.modNum}return y.sort(S=>S.modNum*(this.sortDesc?1:-1))}}O.RevdatParser=x;class I extends t.AbstractParser{match(s){return s.startsWith("SPRSDE")}_parse(){return this.lines.map(s=>{const N=s.extract(12,20),y=s.extract(22,25),g=[s.extract(32,35),s.extract(37,40),s.extract(42,45),s.extract(47,50),s.extract(52,55),s.extract(57,60),s.extract(62,65),s.extract(67,70),s.extract(72,75)];return{sprsdeDate:N,idCode:y,sIdCodes:g.filter(S=>S)}})}}O.SprsdeParser=I;class C extends t.AbstractParser{match(s){if(s.startsWith("REMARK")){const N=(0,r.toIntOrNull)(s.extract(8,10));if(this.remarkNum==N)return!0}return!1}}O.RemarkParser=C;class _ extends C{constructor(){super(...arguments);c(this,"remarkNum",4)}_parse(){const N={idCode:null,relDate:null,version:null},y=12,g=this.lines.map(R=>R.extract(y)).filter(R=>R);if(g.length==0)return N;const S=g[0],E=S.extract(12-y,16-y),w=S.extract(42-y,45-y),T=S.extract(48-y,56-y);return{...N,idCode:E,relDate:T,version:w}}}O.Remark4Parser=_;class M extends C{constructor(){super(...arguments);c(this,"remarkNum",350)}_parse(){var w,T;const N=[];let y=null,g=null;const S=[],E=[];for(const R of this.lines)if(R.extract(11,23)=="BIOMOLECULE:"&&(y!=null&&(N.push({biomolecule:y,biologicalUnit:g,chains:[...S],biomts:[...E]}),g=null,S.length=0,E.length=0),y=(0,r.toIntOrNull)(R.extract(24))),R.extract(12,45)=="AUTHOR DETERMINED BIOLOGICAL UNIT:"&&(g=R.extract(47)),(R.extract(12,41)=="APPLY THE FOLLOWING TO CHAINS:"||R.extract(12,41)=="AND CHAINS:")&&((T=(w=R.extract(43))==null?void 0:w.split(","))==null||T.forEach(L=>{const Q=L.trim();Q&&S.push(Q)})),R.extract(14,18)=="BIOMT"){const L=R.split(/\s+/);E.push(new u(L[2],(0,r.toIntOrNull)(L[3]),(0,r.toFloatOrNull)(L[4]),(0,r.toFloatOrNull)(L[5]),(0,r.toFloatOrNull)(L[6]),(0,r.toFloatOrNull)(L[7])))}return N.push({biomolecule:y,biologicalUnit:g,chains:[...S],biomts:[...E]}),N}}O.Remark350Parser=M;class k extends C{constructor(){super(...arguments);c(this,"remarkNum",465)}_parse(){const N=[];let y=!1;for(const g of this.lines)if(y){const S=g.extract(16,19),E=g.extract(20,20),w=g.extract(22,26),T=g.extract(27,27);N.push({resName:S,chainID:E,resSeq:(0,r.toIntOrNull)(w),iCode:T})}else g.includes("RES C SSSEQI")&&(y=!0);return N}}O.Remark465Parser=k;class B extends C{constructor(){super(...arguments);c(this,"remarkNum",470)}_parse(){const N=(S,E,w,T,R)=>{var L,Q;return{resName:S,chainID:E,resSeq:(0,r.toIntOrNull)(w),iCode:T,atoms:((Q=(L=R==null?void 0:R.split(" "))==null?void 0:L.map(le=>le.trim()))==null?void 0:Q.filter(le=>le))??[]}},y=[];let g=null;for(const S of this.lines)switch(g){case"NonNMR":{const E=S.extract(16,19),w=S.extract(21,21),T=S.extract(22,25),R=S.extract(26,26),L=S.extract(29);y.push(N(E,w,T,R,L));break}case"NMR":{const E=S.extract(16,19),w=S.extract(20,20),T=S.extract(21,24),R=S.extract(25,25),L=S.extract(28);y.push(N(E,w,T,R,L));break}default:S.includes("RES  CSSEQI  ATOMS")?g="NonNMR":S.includes("RES CSSEQI  ATOMS")&&(g="NMR");break}return y}}O.Remark470Parser=B;class j extends t.SectionParser{constructor(){super(...arguments);c(this,"headerParser",new d);c(this,"obslteParser",new m);c(this,"titleParser",new l);c(this,"splitParser",new o);c(this,"caveatParser",new a);c(this,"compndParser",new P);c(this,"sourceParser",new n);c(this,"keywdsParser",new e);c(this,"expdtaParser",new f);c(this,"nummdlParser",new h);c(this,"mdltypParser",new p);c(this,"authorParser",new b);c(this,"revdatParser",new x);c(this,"sprsdeParser",new I);c(this,"remark4Parser",new _);c(this,"remark350Parser",new M);c(this,"remark465Parser",new k);c(this,"remark470Parser",new B)}parsers(){return[this.headerParser,this.obslteParser,this.titleParser,this.splitParser,this.caveatParser,this.compndParser,this.sourceParser,this.keywdsParser,this.expdtaParser,this.nummdlParser,this.mdltypParser,this.authorParser,this.revdatParser,this.sprsdeParser,this.remark4Parser,this.remark350Parser,this.remark465Parser,this.remark470Parser]}parse(){return{header:this.headerParser.parse(),obsltes:this.obslteParser.parse(),title:this.titleParser.parse(),splits:this.splitParser.parse(),caveats:this.caveatParser.parse(),compnds:this.compndParser.parse(),sources:this.sourceParser.parse(),keywds:this.keywdsParser.parse(),expdtas:this.expdtaParser.parse(),nummdl:this.nummdlParser.parse(),mdltyps:this.mdltypParser.parse(),authors:this.authorParser.parse(),revdats:this.revdatParser.parse(),sprsdes:this.sprsdeParser.parse(),remark4:this.remark4Parser.parse(),remark350:this.remark350Parser.parse(),missingResidues:this.remark465Parser.parse(),missingAtoms:this.remark470Parser.parse()}}}return O.TitleSectionParser=j,O}var F={},be;function De(){if(be)return F;be=1,Object.defineProperty(F,"__esModule",{value:!0}),F.PrimaryStructureSectionParser=F.SeqresParser=F.Dbref2Parser=F.Dbref1Parser=F.ModresParser=F.SeqadvParser=F.DbrefParser=void 0,D();const t=Y(),r=D();class u{constructor(e,f,h,p,b,x,I,C,_,M){c(this,"idCode");c(this,"resName");c(this,"chainID");c(this,"resSeq");c(this,"iCode");c(this,"database");c(this,"dbAccession");c(this,"dbRes");c(this,"dbSeq");c(this,"conflict");this.idCode=e,this.resName=f,this.chainID=h,this.resSeq=p,this.iCode=b,this.database=x,this.dbAccession=I,this.dbRes=C,this.dbSeq=_,this.conflict=M}isMutation(){return this.conflict=="ENGINEERED MUTATION"}}class d extends t.AbstractParser{match(e){return e.startsWith("DBREF ")}_parse(){return this.lines.map(e=>{const f=e.extract(8,11),h=e.extract(13,13),p=e.extract(15,18),b=e.extract(19,19),x=e.extract(21,24),I=e.extract(25,25),C=e.extract(27,32),_=e.extract(34,41),M=e.extract(43,54),k=e.extract(56,60),B=e.extract(61,61),j=e.extract(63,67),A=e.extract(68,68);return{idCode:f,chainID:h,seqBegin:(0,r.toIntOrNull)(p),insertBegin:b,seqEnd:(0,r.toIntOrNull)(x),insertEnd:I,database:C,dbAccession:_,dbIdCode:M,dbseqBegin:(0,r.toIntOrNull)(k),idbnsBeg:B,dbseqEnd:(0,r.toIntOrNull)(j),dbinsEnd:A}})}}F.DbrefParser=d;class m extends t.AbstractParser{match(e){return e.startsWith("SEQADV")}_parse(){return this.lines.map(e=>{const f=e.extract(8,11),h=e.extract(13,15),p=e.extract(17,17),b=e.extract(19,22),x=e.extract(23,23),I=e.extract(25,28),C=e.extract(30,38),_=e.extract(40,42),M=e.extract(44,48),k=e.extract(50,70);return new u(f,h,p,(0,r.toIntOrNull)(b),x,I,C,_,(0,r.toIntOrNull)(M),k)})}}F.SeqadvParser=m;class l extends t.AbstractParser{match(e){return e.startsWith("MODRES")}_parse(){return this.lines.map(e=>{const f=e.extract(8,11),h=e.extract(13,15),p=e.extract(17,17),b=e.extract(19,22),x=e.extract(23,23),I=e.extract(25,27),C=e.extract(30,70);return{idCode:f,resName:h,chainID:p,resSeq:(0,r.toIntOrNull)(b),iCode:x,stdRes:I,comment:C}})}}F.ModresParser=l;class o extends t.AbstractParser{match(e){return e.startsWith("DBREF1")}_parse(){return this.lines.map(e=>{const f=e.extract(8,11),h=e.extract(13,13),p=e.extract(15,18),b=e.extract(19,19),x=e.extract(21,24),I=e.extract(25,25),C=e.extract(27,32),_=e.extract(48,67);return{idCode:f,chainID:h,seqBegin:(0,r.toIntOrNull)(p),insertBegin:b,seqEnd:(0,r.toIntOrNull)(x),insertEnd:I,database:C,dbIdCode:_}})}}F.Dbref1Parser=o;class a extends t.AbstractParser{match(e){return e.startsWith("DBREF2")}_parse(){return this.lines.map(e=>{const f=e.extract(8,11),h=e.extract(13,13),p=e.extract(19,40),b=e.extract(46,55),x=e.extract(58,67);return{idCode:f,chainID:h,dbAccession:p,seqBegin:(0,r.toIntOrNull)(b),seqEnd:(0,r.toIntOrNull)(x)}})}}F.Dbref2Parser=a;class i extends t.AbstractParser{match(e){return e.startsWith("SEQRES")}_parse(){return this.lines.map(e=>{const f=e.extract(8,10),h=e.extract(12,12),p=e.extract(14,17),b=[e.extract(20,22),e.extract(24,26),e.extract(28,30),e.extract(32,34),e.extract(36,38),e.extract(40,42),e.extract(44,46),e.extract(48,50),e.extract(52,54),e.extract(56,58),e.extract(60,62),e.extract(64,66),e.extract(68,70)];return{serNum:(0,r.toIntOrNull)(f),chainID:h,numRes:(0,r.toIntOrNull)(p),resNames:b.filter(x=>x)}})}}F.SeqresParser=i;class P extends t.SectionParser{constructor(){super(...arguments);c(this,"dbrefParser",new d);c(this,"seqadvParser",new m);c(this,"modresParser",new l);c(this,"dbref1Parser",new o);c(this,"dbref2Parser",new a);c(this,"seqresParser",new i)}parsers(){return[this.dbrefParser,this.seqadvParser,this.modresParser,this.dbref1Parser,this.dbref2Parser,this.seqresParser]}parse(){return{dbrefs:this.dbrefParser.parse(),seqadvs:this.seqadvParser.parse(),modress:this.modresParser.parse(),dbref1s:this.dbref1Parser.parse(),dbref2s:this.dbref2Parser.parse(),seqress:this.seqresParser.parse()}}}return F.PrimaryStructureSectionParser=P,F}var W={},xe;function qe(){if(xe)return W;xe=1,Object.defineProperty(W,"__esModule",{value:!0}),W.HeterogenSectionParser=W.FormulParser=W.HetsynParser=W.HetnamParser=W.HetParser=void 0,D();const t=Y(),r=D();class u extends t.AbstractParser{match(i){return i.startsWith("HET   ")}_parse(){return this.lines.map(i=>{const P=i.extract(8,10),n=i.extract(13,13),e=i.extract(14,17),f=i.extract(18,18),h=i.extract(21,25),p=i.extract(31,70);return{hetID:P,chainID:n,seqNum:(0,r.toIntOrNull)(e),iCode:f,numHetAtoms:(0,r.toIntOrNull)(h),text:p}})}}W.HetParser=u;class d extends t.AbstractParser{match(i){return i.startsWith("HETNAM")}_parse(){const i=this.lines.map(n=>{const e=n.extract(12,14),f=n.extract(16,70);return[e,f]}).reduce((n,[e,f])=>(n[e]=n[e]??[],n[e].push(f),n),{}),P=[];for(const n in i){const e=i[n].join(" ");P.push({hetID:n,text:e.isBlank()?null:e})}return P}}W.HetnamParser=d;class m extends t.AbstractParser{match(i){return i.startsWith("HETSYN")}_parse(){const i=this.lines.map(n=>{const e=n.extract(12,14),f=n.extract(16,70);return[e,f]}).reduce((n,[e,f])=>(n[e]=n[e]??[],n[e].push(f),n),{}),P=[];for(const n in i){const e=i[n].join(" ");P.push({hetID:n,hetSynonyms:e.isBlank()?null:e})}return P}}W.HetsynParser=m;class l extends t.AbstractParser{match(i){return i.startsWith("FORMUL")}_parse(){return this.lines.map(i=>{const P=i.extract(9,10),n=i.extract(13,15),e=i.extract(17,18),f=i.extract(19,19),h=i.extract(20,70);return{compNum:(0,r.toIntOrNull)(P),hetID:n,continuation:(0,r.toIntOrNull)(e),asterisk:f,text:h}})}}W.FormulParser=l;class o extends t.SectionParser{constructor(){super(...arguments);c(this,"hetParser",new u);c(this,"hetnamParser",new d);c(this,"hetsynParser",new m);c(this,"formulParser",new l)}parsers(){return[this.hetParser,this.hetnamParser,this.hetsynParser,this.formulParser]}parse(){return{hets:this.hetParser.parse(),hetnams:this.hetnamParser.parse(),hetsyns:this.hetsynParser.parse(),formuls:this.formulParser.parse()}}}return W.HeterogenSectionParser=o,W}var X={},Ne;function ke(){if(Ne)return X;Ne=1,Object.defineProperty(X,"__esModule",{value:!0}),X.SecondaryStructureSectionParser=X.SheetParser=X.HelixParser=void 0,D();const t=Y(),r=D();class u extends t.AbstractParser{match(o){return o.startsWith("HELIX ")}_parse(){return this.lines.map(o=>{const a=o.extract(8,10),i=o.extract(12,14),P=o.extract(16,18),n=o.extract(20,20),e=o.extract(22,25),f=o.extract(26,26),h=o.extract(28,30),p=o.extract(32,32),b=o.extract(34,37),x=o.extract(38,38),I=o.extract(39,40),C=o.extract(41,70),_=o.extract(72,76);return{serNum:(0,r.toIntOrNull)(a),helixID:i,initResidue:{resName:P,chainID:n,resSeq:(0,r.toIntOrNull)(e),iCode:f},endResidue:{resName:h,chainID:p,resSeq:(0,r.toIntOrNull)(b),iCode:x},helixClass:(0,r.toIntOrNull)(I),comment:C,length:(0,r.toIntOrNull)(_)}})}}X.HelixParser=u;class d extends t.AbstractParser{match(o){return o.startsWith("SHEET ")}_parse(){return this.lines.map(o=>{const a=o.extract(8,10),i=o.extract(12,14),P=o.extract(15,16),n=o.extract(18,20),e=o.extract(22,22),f=o.extract(23,26),h=o.extract(27,27),p=o.extract(29,31),b=o.extract(33,33),x=o.extract(34,37),I=o.extract(38,38),C=o.extract(39,40),_=o.extract(42,45),M=o.extract(46,48),k=o.extract(50,50),B=o.extract(51,54),j=o.extract(55,55),A=o.extract(57,60),s=o.extract(61,63),N=o.extract(65,65),y=o.extract(66,69),g=o.extract(70,70);return{strand:(0,r.toIntOrNull)(a),sheetID:i,numStrands:(0,r.toIntOrNull)(P),initResidue:{resName:n,chainID:e,resSeq:(0,r.toIntOrNull)(f),iCode:h},endResidue:{resName:p,chainID:b,resSeq:(0,r.toIntOrNull)(x),iCode:I},sense:(0,r.toIntOrNull)(C),curResidue:{atom:_,resName:M,chainID:k,resSeq:(0,r.toIntOrNull)(B),iCode:j},prevResidue:{atom:A,resName:s,chainID:N,resSeq:(0,r.toIntOrNull)(y),iCode:g}}})}}X.SheetParser=d;class m extends t.SectionParser{constructor(){super(...arguments);c(this,"helixParser",new u);c(this,"sheetParser",new d)}parsers(){return[this.helixParser,this.sheetParser]}parse(){return{helixs:this.helixParser.parse(),sheets:this.sheetParser.parse()}}}return X.SecondaryStructureSectionParser=m,X}var U={},Oe;function we(){if(Oe)return U;Oe=1,Object.defineProperty(U,"__esModule",{value:!0}),U.ConnectivityAnnotationSectionParser=U.CispepParser=U.LinkParser=U.SsbondParser=void 0,D();const t=Y(),r=D();class u extends t.AbstractParser{match(a){return a.startsWith("SSBOND")}_parse(){return this.lines.map(a=>{const i=a.extract(8,10),P=a.extract(12,14),n=a.extract(16,16),e=a.extract(18,21),f=a.extract(22,22),h=a.extract(26,28),p=a.extract(30,30),b=a.extract(32,35),x=a.extract(36,36),I=a.extract(60,65),C=a.extract(67,72),_=a.extract(74,78);return{serNum:(0,r.toIntOrNull)(i),residue1:{resName:P??"CYS",chainID:n,resSeq:(0,r.toIntOrNull)(e),iCode:f},residue2:{resName:h??"CYS",chainID:p,resSeq:(0,r.toIntOrNull)(b),iCode:x},sym1:I,sym2:C,Length:(0,r.toFloatOrNull)(_)}})}}U.SsbondParser=u;class d extends t.AbstractParser{match(a){return a.startsWith("LINK  ")}_parse(){return this.lines.map(a=>{const i=a.extract(13,16),P=a.extract(17,17),n=a.extract(18,20),e=a.extract(22,22),f=a.extract(23,26),h=a.extract(27,27),p=a.extract(43,46),b=a.extract(47,47),x=a.extract(48,50),I=a.extract(52,52),C=a.extract(53,56),_=a.extract(57,57),M=a.extract(60,65),k=a.extract(67,72),B=a.extract(74,78);return{residue1:{atom:i,altLoc:P,resName:n,chainID:e,resSeq:(0,r.toIntOrNull)(f),iCode:h},residue2:{atom:p,altLoc:b,resName:x,chainID:I,resSeq:(0,r.toIntOrNull)(C),iCode:_},sym1:M,sym2:k,Length:(0,r.toFloatOrNull)(B)}})}}U.LinkParser=d;class m extends t.AbstractParser{match(a){return a.startsWith("CISPEP")}_parse(){return this.lines.map(a=>{const i=a.extract(8,10),P=a.extract(12,14),n=a.extract(16,16),e=a.extract(18,21),f=a.extract(22,22),h=a.extract(26,28),p=a.extract(30,30),b=a.extract(32,35),x=a.extract(36,36),I=a.extract(44,46),C=a.extract(54,59);return{serNum:(0,r.toIntOrNull)(i),residue1:{resName:P,chainID:n,resSeq:(0,r.toIntOrNull)(e),iCode:f},residue2:{resName:h,chainID:p,resSeq:(0,r.toIntOrNull)(b),iCode:x},modNum:(0,r.toIntOrNull)(I),measure:(0,r.toFloatOrNull)(C)}})}}U.CispepParser=m;class l extends t.SectionParser{constructor(){super(...arguments);c(this,"ssbondParser",new u);c(this,"linkParser",new d);c(this,"cispepParser",new m)}parsers(){return[this.ssbondParser,this.linkParser,this.cispepParser]}parse(){return{ssbonds:this.ssbondParser.parse(),links:this.linkParser.parse(),cispeps:this.cispepParser.parse()}}}return U.ConnectivityAnnotationSectionParser=l,U}var re={},ye;function Le(){if(ye)return re;ye=1,Object.defineProperty(re,"__esModule",{value:!0}),re.MiscellaneousFeaturesSectionParser=re.SiteParser=void 0,D();const t=Y(),r=D();class u extends t.AbstractParser{match(l){return l.startsWith("SITE  ")}_parse(){const l=(o,a,i,P)=>o==null||a==null||i==null?null:{resName:o,chainID:a,resSeq:(0,r.toIntOrNull)(i),iCode:P};return this.lines.map(o=>{const a=o.extract(8,10),i=o.extract(12,14),P=o.extract(16,17),n=o.extract(19,21),e=o.extract(23,23),f=o.extract(24,27),h=o.extract(28,28),p=o.extract(30,32),b=o.extract(34,34),x=o.extract(35,38),I=o.extract(39,39),C=o.extract(41,43),_=o.extract(45,45),M=o.extract(46,49),k=o.extract(50,50),B=o.extract(52,54),j=o.extract(56,56),A=o.extract(57,60),s=o.extract(61,61);return{seqNum:(0,r.toIntOrNull)(a),siteID:i,numRes:(0,r.toIntOrNull)(P),residues:[l(n,e,f,h),l(p,b,x,I),l(C,_,M,k),l(B,j,A,s)].filter(N=>N)}})}validate(l){const o=l.reduce((a,i)=>{const P=i.siteID+"	"+i.numRes;return a[P]=a[P]??[],a[P].push(...i.residues),a},{});for(const a in o){const[i,P]=a.split("	"),n=o[a].length;if(parseInt(P)!=n)return console.error(`"${i}" length error. expected : ${P}, actual : ${n}`),!1}return!0}}re.SiteParser=u;class d extends t.SectionParser{constructor(){super(...arguments);c(this,"siteParser",new u)}parsers(){return[this.siteParser]}parse(){return{sites:this.siteParser.parse()}}}return re.MiscellaneousFeaturesSectionParser=d,re}var q={},Ce;function Fe(){if(Ce)return q;Ce=1,Object.defineProperty(q,"__esModule",{value:!0}),q.CrystallographicAndCoordinateTransformationSectionParser=q.MtrixParser=q.ScaleParser=q.OrigxParser=q.Cryst1Parser=q.Mtrix=q.Scale=q.Origx=void 0,D();const t=Y(),r=D();class u{constructor(e,f,h,p,b){c(this,"recordName");c(this,"On1");c(this,"On2");c(this,"On3");c(this,"Tn");this.recordName=e,this.On1=f,this.On2=h,this.On3=p,this.Tn=b}toPoint4D(){return[this.On1,this.On2,this.On3,this.Tn]}}q.Origx=u;class d{constructor(e,f,h,p,b){c(this,"recordName");c(this,"Sn1");c(this,"Sn2");c(this,"Sn3");c(this,"Un");this.recordName=e,this.Sn1=f,this.Sn2=h,this.Sn3=p,this.Un=b}toPoint4D(){return[this.Sn1,this.Sn2,this.Sn3,this.Un]}}q.Scale=d;class m{constructor(e,f,h,p,b,x,I){c(this,"recordName");c(this,"serial");c(this,"Mn1");c(this,"Mn2");c(this,"Mn3");c(this,"Vn");c(this,"iGiven");this.recordName=e,this.serial=f,this.Mn1=h,this.Mn2=p,this.Mn3=b,this.Vn=x,this.iGiven=I}toPoint4D(){return[this.Mn1,this.Mn2,this.Mn3,this.Vn]}}q.Mtrix=m;class l extends t.AbstractParser{match(e){return e.startsWith("CRYST1")}_parse(){if(this.lines.length==0)return null;const e=this.lines[0],f=e.extract(7,15),h=e.extract(16,24),p=e.extract(25,33),b=e.extract(34,40),x=e.extract(41,47),I=e.extract(48,54),C=e.extract(56,66),_=e.extract(67,70);return{a:(0,r.toFloatOrNull)(f),b:(0,r.toFloatOrNull)(h),c:(0,r.toFloatOrNull)(p),alpha:(0,r.toFloatOrNull)(b),beta:(0,r.toFloatOrNull)(x),gamma:(0,r.toFloatOrNull)(I),sGroup:C,z:(0,r.toIntOrNull)(_)}}}q.Cryst1Parser=l;class o extends t.AbstractParser{match(e){return e.startsWith("ORIGX1")||e.startsWith("ORIGX2")||e.startsWith("ORIGX3")}_parse(){return this.lines.map(e=>{const f=e.extract(1,6),h=e.extract(11,20),p=e.extract(21,30),b=e.extract(31,40),x=e.extract(46,55);return new u(f,(0,r.toFloatOrNull)(h),(0,r.toFloatOrNull)(p),(0,r.toFloatOrNull)(b),(0,r.toFloatOrNull)(x))})}}q.OrigxParser=o;class a extends t.AbstractParser{match(e){return e.startsWith("SCALE1")||e.startsWith("SCALE2")||e.startsWith("SCALE3")}_parse(){return this.lines.map(e=>{const f=e.extract(1,6),h=e.extract(11,20),p=e.extract(21,30),b=e.extract(31,40),x=e.extract(46,55);return new d(f,(0,r.toFloatOrNull)(h),(0,r.toFloatOrNull)(p),(0,r.toFloatOrNull)(b),(0,r.toFloatOrNull)(x))})}}q.ScaleParser=a;class i extends t.AbstractParser{match(e){return e.startsWith("MTRIX1")||e.startsWith("MTRIX2")||e.startsWith("MTRIX3")}_parse(){return this.lines.map(e=>{const f=e.extract(1,6),h=e.extract(8,11),p=e.extract(11,20),b=e.extract(21,30),x=e.extract(31,40),I=e.extract(46,55),C=e.extract(60,60);return new m(f,(0,r.toIntOrNull)(h),(0,r.toFloatOrNull)(p),(0,r.toFloatOrNull)(b),(0,r.toFloatOrNull)(x),(0,r.toFloatOrNull)(I),(0,r.toIntOrNull)(C))})}}q.MtrixParser=i;class P extends t.SectionParser{constructor(){super(...arguments);c(this,"cryst1Parser",new l);c(this,"origxParser",new o);c(this,"scaleParser",new a);c(this,"mtrixParser",new i)}parsers(){return[this.cryst1Parser,this.origxParser,this.scaleParser,this.mtrixParser]}parse(){return{cryst1:this.cryst1Parser.parse(),origxs:this.origxParser.parse(),scales:this.scaleParser.parse(),mtrixs:this.mtrixParser.parse()}}}return q.CrystallographicAndCoordinateTransformationSectionParser=P,q}var H={},Ie;function Be(){if(Ie)return H;Ie=1,Object.defineProperty(H,"__esModule",{value:!0}),H.CoordinateSectionParser=H.HetatmParser=H.AnisouParser=H.AtomParser=H.Atom=H.Hetatm=void 0,D();const t=Y(),r=D();class u{constructor(n){c(this,"data");this.data=n}toResidue(){return{resName:this.data.resName,chainID:this.data.chainID,resSeq:this.data.resSeq,iCode:this.data.iCode}}static lineToCoordinate(n){const e=n.extract(7,11),f=n.extract(13,16),h=n.extract(17,17),p=n.extract(18,20),b=n.extract(22,22),x=n.extract(23,26),I=n.extract(27,27),C=n.extract(31,38),_=n.extract(39,46),M=n.extract(47,54),k=n.extract(55,60),B=n.extract(61,66),j=n.extract(77,78),A=n.extract(79,80);return{serial:(0,r.toIntOrNull)(e),atom:f,altLoc:h,resName:p,chainID:b,resSeq:(0,r.toIntOrNull)(x),iCode:I,x:(0,r.toFloatOrNull)(C),y:(0,r.toFloatOrNull)(_),z:(0,r.toFloatOrNull)(M),occupancy:(0,r.toFloatOrNull)(k),tempFactor:(0,r.toFloatOrNull)(B),element:j,charge:A}}}class d extends u{isCrystalWater(){return this.data.resName=="HOH"}isDummy(){return this.data.resName=="DUM"}}H.Hetatm=d;class m extends u{}H.Atom=m;class l extends t.AbstractParser{constructor(e=null){super();c(this,"filter");this.filter=e}match(e){return e.startsWith("ATOM  ")}_parse(){const e=[];for(let f of this.lines){const h=new m(u.lineToCoordinate(f));this.filter!=null?this.filter(h)&&e.push(h):e.push(h)}return e}}H.AtomParser=l;class o extends t.AbstractParser{match(n){return n.startsWith("ANISOU")}_parse(){return this.lines.map(n=>{const e=n.extract(7,11),f=n.extract(13,16),h=n.extract(17,17),p=n.extract(18,20),b=n.extract(22,22),x=n.extract(23,26),I=n.extract(27,27),C=n.extract(29,35),_=n.extract(36,42),M=n.extract(43,49),k=n.extract(50,56),B=n.extract(57,63),j=n.extract(64,70),A=n.extract(77,78),s=n.extract(79,80);return{serial:(0,r.toIntOrNull)(e),atom:f,altLoc:h,resName:p,chainID:b,resSeq:(0,r.toIntOrNull)(x),iCode:I,u00:(0,r.toIntOrNull)(C),u11:(0,r.toIntOrNull)(_),u22:(0,r.toIntOrNull)(M),u01:(0,r.toIntOrNull)(k),u02:(0,r.toIntOrNull)(B),u12:(0,r.toIntOrNull)(j),element:A,charge:s}})}}H.AnisouParser=o;class a extends t.AbstractParser{constructor(e=!0,f=null){super();c(this,"excludeDummy");c(this,"filter");this.excludeDummy=e,this.filter=f}match(e){return this.excludeDummy&&e.extract(18,20)=="DUM"?!1:e.startsWith("HETATM")}_parse(){const e=[];for(let f of this.lines){const h=new d(u.lineToCoordinate(f));this.filter!=null?this.filter(h)&&e.push(h):e.push(h)}return e}}H.HetatmParser=a;class i extends t.SectionParser{constructor(e=!0,f=!0,h=null,p=null){super();c(this,"atomParer");c(this,"anisouParser");c(this,"hetatmParser");this.atomParer=new l(h),this.hetatmParser=new a(e,p),this.anisouParser=f?null:new o}parsers(){return[this.atomParer,this.anisouParser,this.hetatmParser].filter(e=>e)}parse(){var e;return{atoms:this.atomParer.parse(),anisous:((e=this.anisouParser)==null?void 0:e.parse())??[],hetatms:this.hetatmParser.parse()}}}return H.CoordinateSectionParser=i,H}var se={},ge;function He(){if(ge)return se;ge=1,Object.defineProperty(se,"__esModule",{value:!0}),se.ConnectivitySectionParser=se.ConectParser=void 0,D();const t=Y(),r=D();class u extends t.AbstractParser{match(l){return l.startsWith("CONECT")}_parse(){return this.lines.map(l=>{const o=l.extract(7,11),a=[l.extract(12,16),l.extract(17,21),l.extract(22,26),l.extract(27,31)];return{atomSeqNum:(0,r.toIntOrNull)(o),bondedAtomSeqNums:a.filter(i=>i).map(i=>(0,r.toIntOrNull)(i))}})}}se.ConectParser=u;class d extends t.SectionParser{constructor(){super(...arguments);c(this,"conectParser",new u)}parsers(){return[this.conectParser]}parse(){return{conects:this.conectParser.parse()}}}return se.ConnectivitySectionParser=d,se}var ae={},Ae;function je(){if(Ae)return ae;Ae=1,Object.defineProperty(ae,"__esModule",{value:!0}),ae.BookkeepingSectionParser=ae.MasterParser=void 0,D();const t=Y(),r=D();class u extends t.AbstractParser{match(l){return l.startsWith("MASTER")}_parse(){if(this.lines.length==0)return null;const l=this.lines[0],o=l.extract(11,15),a=l.extract(21,25),i=l.extract(26,30),P=l.extract(31,35),n=l.extract(36,40),e=l.extract(41,45),f=l.extract(46,50),h=l.extract(51,55),p=l.extract(56,60),b=l.extract(61,65),x=l.extract(66,70);return{numRemark:(0,r.toIntOrNull)(o),numHet:(0,r.toIntOrNull)(a),numHelix:(0,r.toIntOrNull)(i),numSheet:(0,r.toIntOrNull)(P),numTurn:(0,r.toIntOrNull)(n),numSite:(0,r.toIntOrNull)(e),numXform:(0,r.toIntOrNull)(f),numCoord:(0,r.toIntOrNull)(h),numTer:(0,r.toIntOrNull)(p),numConect:(0,r.toIntOrNull)(b),numSeq:(0,r.toIntOrNull)(x)}}}ae.MasterParser=u;class d extends t.SectionParser{constructor(){super(...arguments);c(this,"masterParser",new u)}parsers(){return[this.masterParser]}parse(){return{master:this.masterParser.parse()}}}return ae.BookkeepingSectionParser=d,ae}var _e;function Qe(){if(_e)return J;_e=1,Object.defineProperty(J,"__esModule",{value:!0}),J.PdbParser=J.Pdb=void 0;const t=Te(),r=De(),u=qe(),d=ke(),m=we(),l=Le(),o=Fe(),a=Be(),i=He(),P=je(),n=Y();class e{constructor(p,b,x,I,C,_,M,k,B,j){c(this,"title");c(this,"primaryStructure");c(this,"heterogen");c(this,"secondaryStructure");c(this,"connectivityAnnotation");c(this,"miscellaneousFeatures");c(this,"crystallographicAndCoordinateTransformation");c(this,"coordinate");c(this,"connectivity");c(this,"bookkeeping");this.title=p,this.primaryStructure=b,this.heterogen=x,this.secondaryStructure=I,this.connectivityAnnotation=C,this.miscellaneousFeatures=_,this.crystallographicAndCoordinateTransformation=M,this.coordinate=k,this.connectivity=B,this.bookkeeping=j}}J.Pdb=e;class f extends n.SectionParser{constructor(b=!0,x=!0,I=null,C=null){super();c(this,"titleSectionParser",new t.TitleSectionParser);c(this,"primaryStructureSectionParser",new r.PrimaryStructureSectionParser);c(this,"heterogenSectionParser",new u.HeterogenSectionParser);c(this,"secondaryStructureSectionParser",new d.SecondaryStructureSectionParser);c(this,"connectivityAnnotationSectionParser",new m.ConnectivityAnnotationSectionParser);c(this,"miscellaneousFeaturesSectionParser",new l.MiscellaneousFeaturesSectionParser);c(this,"crystallographicAndCoordinateTransformationSectionParser",new o.CrystallographicAndCoordinateTransformationSectionParser);c(this,"coordinateSectionParser");c(this,"connectivitySectionParser",new i.ConnectivitySectionParser);c(this,"bookkeepingSectionParser",new P.BookkeepingSectionParser);this.coordinateSectionParser=new a.CoordinateSectionParser(b,x,I,C)}parsers(){return[this.titleSectionParser,this.primaryStructureSectionParser,this.heterogenSectionParser,this.secondaryStructureSectionParser,this.connectivityAnnotationSectionParser,this.miscellaneousFeaturesSectionParser,this.crystallographicAndCoordinateTransformationSectionParser,this.coordinateSectionParser,this.connectivitySectionParser,this.bookkeepingSectionParser]}parse(){return new e(this.titleSectionParser.parse(),this.primaryStructureSectionParser.parse(),this.heterogenSectionParser.parse(),this.secondaryStructureSectionParser.parse(),this.connectivityAnnotationSectionParser.parse(),this.miscellaneousFeaturesSectionParser.parse(),this.crystallographicAndCoordinateTransformationSectionParser.parse(),this.coordinateSectionParser.parse(),this.connectivitySectionParser.parse(),this.bookkeepingSectionParser.parse())}}return J.PdbParser=f,J}var Ee;function Ze(){return Ee||(Ee=1,function(t){Object.defineProperty(t,"__esModule",{value:!0}),t.ConnectivitySectionParser=t.HetatmParser=t.AnisouParser=t.AtomParser=t.CoordinateSectionParser=t.MtrixParser=t.ScaleParser=t.OrigxParser=t.Cryst1Parser=t.CrystallographicAndCoordinateTransformationSectionParser=t.SiteParser=t.MiscellaneousFeaturesSectionParser=t.CispepParser=t.LinkParser=t.SsbondParser=t.ConnectivityAnnotationSectionParser=t.SheetParser=t.HelixParser=t.SecondaryStructureSectionParser=t.FormulParser=t.HetsynParser=t.HetnamParser=t.HetParser=t.HeterogenSectionParser=t.SeqresParser=t.Dbref2Parser=t.Dbref1Parser=t.ModresParser=t.SeqadvParser=t.DbrefParser=t.PrimaryStructureSectionParser=t.Remark470Parser=t.Remark465Parser=t.RemarkParser=t.SprsdeParser=t.RevdatParser=t.AuthorParser=t.MdltypParser=t.NummdlParser=t.ExpdtaParser=t.KeywdsParser=t.SourceParser=t.CompndParser=t.CaveatParser=t.SplitParser=t.TitleParser=t.ObslteParser=t.HeaderParser=t.TitleSectionParser=t.PdbParser=void 0,t.MasterParser=t.BookkeepingSectionParser=t.ConectParser=void 0;const r=Qe();Object.defineProperty(t,"PdbParser",{enumerable:!0,get:function(){return r.PdbParser}});const u=je();Object.defineProperty(t,"BookkeepingSectionParser",{enumerable:!0,get:function(){return u.BookkeepingSectionParser}}),Object.defineProperty(t,"MasterParser",{enumerable:!0,get:function(){return u.MasterParser}});const d=He();Object.defineProperty(t,"ConectParser",{enumerable:!0,get:function(){return d.ConectParser}}),Object.defineProperty(t,"ConnectivitySectionParser",{enumerable:!0,get:function(){return d.ConnectivitySectionParser}});const m=we();Object.defineProperty(t,"CispepParser",{enumerable:!0,get:function(){return m.CispepParser}}),Object.defineProperty(t,"ConnectivityAnnotationSectionParser",{enumerable:!0,get:function(){return m.ConnectivityAnnotationSectionParser}}),Object.defineProperty(t,"LinkParser",{enumerable:!0,get:function(){return m.LinkParser}}),Object.defineProperty(t,"SsbondParser",{enumerable:!0,get:function(){return m.SsbondParser}});const l=Be();Object.defineProperty(t,"AnisouParser",{enumerable:!0,get:function(){return l.AnisouParser}}),Object.defineProperty(t,"AtomParser",{enumerable:!0,get:function(){return l.AtomParser}}),Object.defineProperty(t,"CoordinateSectionParser",{enumerable:!0,get:function(){return l.CoordinateSectionParser}}),Object.defineProperty(t,"HetatmParser",{enumerable:!0,get:function(){return l.HetatmParser}});const o=Fe();Object.defineProperty(t,"Cryst1Parser",{enumerable:!0,get:function(){return o.Cryst1Parser}}),Object.defineProperty(t,"CrystallographicAndCoordinateTransformationSectionParser",{enumerable:!0,get:function(){return o.CrystallographicAndCoordinateTransformationSectionParser}}),Object.defineProperty(t,"MtrixParser",{enumerable:!0,get:function(){return o.MtrixParser}}),Object.defineProperty(t,"OrigxParser",{enumerable:!0,get:function(){return o.OrigxParser}}),Object.defineProperty(t,"ScaleParser",{enumerable:!0,get:function(){return o.ScaleParser}});const a=qe();Object.defineProperty(t,"FormulParser",{enumerable:!0,get:function(){return a.FormulParser}}),Object.defineProperty(t,"HeterogenSectionParser",{enumerable:!0,get:function(){return a.HeterogenSectionParser}}),Object.defineProperty(t,"HetnamParser",{enumerable:!0,get:function(){return a.HetnamParser}}),Object.defineProperty(t,"HetParser",{enumerable:!0,get:function(){return a.HetParser}}),Object.defineProperty(t,"HetsynParser",{enumerable:!0,get:function(){return a.HetsynParser}});const i=Le();Object.defineProperty(t,"MiscellaneousFeaturesSectionParser",{enumerable:!0,get:function(){return i.MiscellaneousFeaturesSectionParser}}),Object.defineProperty(t,"SiteParser",{enumerable:!0,get:function(){return i.SiteParser}});const P=De();Object.defineProperty(t,"Dbref1Parser",{enumerable:!0,get:function(){return P.Dbref1Parser}}),Object.defineProperty(t,"Dbref2Parser",{enumerable:!0,get:function(){return P.Dbref2Parser}}),Object.defineProperty(t,"DbrefParser",{enumerable:!0,get:function(){return P.DbrefParser}}),Object.defineProperty(t,"ModresParser",{enumerable:!0,get:function(){return P.ModresParser}}),Object.defineProperty(t,"PrimaryStructureSectionParser",{enumerable:!0,get:function(){return P.PrimaryStructureSectionParser}}),Object.defineProperty(t,"SeqadvParser",{enumerable:!0,get:function(){return P.SeqadvParser}}),Object.defineProperty(t,"SeqresParser",{enumerable:!0,get:function(){return P.SeqresParser}});const n=ke();Object.defineProperty(t,"HelixParser",{enumerable:!0,get:function(){return n.HelixParser}}),Object.defineProperty(t,"SecondaryStructureSectionParser",{enumerable:!0,get:function(){return n.SecondaryStructureSectionParser}}),Object.defineProperty(t,"SheetParser",{enumerable:!0,get:function(){return n.SheetParser}});const e=Te();Object.defineProperty(t,"AuthorParser",{enumerable:!0,get:function(){return e.AuthorParser}}),Object.defineProperty(t,"CaveatParser",{enumerable:!0,get:function(){return e.CaveatParser}}),Object.defineProperty(t,"CompndParser",{enumerable:!0,get:function(){return e.CompndParser}}),Object.defineProperty(t,"ExpdtaParser",{enumerable:!0,get:function(){return e.ExpdtaParser}}),Object.defineProperty(t,"HeaderParser",{enumerable:!0,get:function(){return e.HeaderParser}}),Object.defineProperty(t,"KeywdsParser",{enumerable:!0,get:function(){return e.KeywdsParser}}),Object.defineProperty(t,"MdltypParser",{enumerable:!0,get:function(){return e.MdltypParser}}),Object.defineProperty(t,"NummdlParser",{enumerable:!0,get:function(){return e.NummdlParser}}),Object.defineProperty(t,"ObslteParser",{enumerable:!0,get:function(){return e.ObslteParser}}),Object.defineProperty(t,"Remark465Parser",{enumerable:!0,get:function(){return e.Remark465Parser}}),Object.defineProperty(t,"Remark470Parser",{enumerable:!0,get:function(){return e.Remark470Parser}}),Object.defineProperty(t,"RemarkParser",{enumerable:!0,get:function(){return e.RemarkParser}}),Object.defineProperty(t,"RevdatParser",{enumerable:!0,get:function(){return e.RevdatParser}}),Object.defineProperty(t,"SourceParser",{enumerable:!0,get:function(){return e.SourceParser}}),Object.defineProperty(t,"SplitParser",{enumerable:!0,get:function(){return e.SplitParser}}),Object.defineProperty(t,"SprsdeParser",{enumerable:!0,get:function(){return e.SprsdeParser}}),Object.defineProperty(t,"TitleParser",{enumerable:!0,get:function(){return e.TitleParser}}),Object.defineProperty(t,"TitleSectionParser",{enumerable:!0,get:function(){return e.TitleSectionParser}})}(Pe)),Pe}var $e=Ze();const Je=["example","1jjj","AF_AFB5EZH0F1","MA_MACOFFESLACC104963G1I1","AF-U7Q5H6-F1-model_v4","AF-Q6LA55-F1-model_v4","4v4l"],ot=async t=>{try{const r=await ze(Object.assign({"../../assets/pdb/1jjj.pdb":()=>$(()=>import("./1jjj.B8rkok_Y.js"),[],import.meta.url),"../../assets/pdb/4v4l.pdb":()=>$(()=>import("./4v4l.DSGG9VWu.js"),[],import.meta.url),"../../assets/pdb/af-q6la55-f1-model_v4.pdb":()=>$(()=>import("./af-q6la55-f1-model_v4.1eBkngER.js"),[],import.meta.url),"../../assets/pdb/af-u7q5h6-f1-model_v4.pdb":()=>$(()=>import("./af-u7q5h6-f1-model_v4.DeCkChaF.js"),[],import.meta.url),"../../assets/pdb/af_afb5ezh0f1.pdb":()=>$(()=>import("./af_afb5ezh0f1.Blda0tTZ.js"),[],import.meta.url),"../../assets/pdb/example.pdb":()=>$(()=>import("./example.D5y5BK6Y.js"),[],import.meta.url),"../../assets/pdb/ma_macoffeslacc104963g1i1.pdb":()=>$(()=>import("./ma_macoffeslacc104963g1i1.DQrn-vgJ.js"),[],import.meta.url)}),`../../assets/pdb/${t.toLowerCase()}.pdb`,5),u=new $e.PdbParser;return u.collect(r.default.split(`
`)),u.parse()}catch(r){console.error("error",r)}},Re={defaultColor:"#ff1493",Jmol:{H:"#ffffff",He:"#d9ffff",HE:"#d9ffff",Li:"#cc80ff",LI:"#cc80ff",Be:"#c2ff00",BE:"#c2ff00",B:"#ffb5b5",C:"#909090",N:"#3050f8",O:"#ff0d0d",F:"#90e050",Ne:"#b3e3f5",NE:"#b3e3f5",Na:"#ab5cf2",NA:"#ab5cf2",Mg:"#8aff00",MG:"#8aff00",Al:"#bfa6a6",AL:"#bfa6a6",Si:"#f0c8a0",SI:"#f0c8a0",P:"#ff8000",S:"#ffff30",Cl:"#1ff01f",CL:"#1ff01f",Ar:"#80d1e3",AR:"#80d1e3",K:"#8f40d4",Ca:"#3dff00",CA:"#3dff00",Sc:"#e6e6e6",SC:"#e6e6e6",Ti:"#bfc2c7",TI:"#bfc2c7",V:"#a6a6ab",Cr:"#8a99c7",CR:"#8a99c7",Mn:"#9c7ac7",MN:"#9c7ac7",Fe:"#e06633",FE:"#e06633",Co:"#f090a0",CO:"#f090a0",Ni:"#50d050",NI:"#50d050",Cu:"#c88033",CU:"#c88033",Zn:"#7d80b0",ZN:"#7d80b0",Ga:"#c28f8f",GA:"#c28f8f",Ge:"#668f8f",GE:"#668f8f",As:"#bd80e3",AS:"#bd80e3",Se:"#ffa100",SE:"#ffa100",Br:"#a62929",BR:"#a62929",Kr:"#5cb8d1",KR:"#5cb8d1",Rb:"#702eb0",RB:"#702eb0",Sr:"#00ff00",SR:"#00ff00",Y:"#94ffff",Zr:"#94e0e0",ZR:"#94e0e0",Nb:"#73c2c9",NB:"#73c2c9",Mo:"#54b5b5",MO:"#54b5b5",Tc:"#3b9e9e",TC:"#3b9e9e",Ru:"#248f8f",RU:"#248f8f",Rh:"#0a7d8c",RH:"#0a7d8c",Pd:"#006985",PD:"#006985",Ag:"#c0c0c0",AG:"#c0c0c0",Cd:"#ffd98f",CD:"#ffd98f",In:"#a67573",IN:"#a67573",Sn:"#668080",SN:"#668080",Sb:"#9e63b5",SB:"#9e63b5",Te:"#d47a00",TE:"#d47a00",I:"#940094",Xe:"#429eb0",XE:"#429eb0",Cs:"#57178f",CS:"#57178f",Ba:"#00c900",BA:"#00c900",La:"#70d4ff",LA:"#70d4ff",Ce:"#ffffc7",CE:"#ffffc7",Pr:"#d9ffc7",PR:"#d9ffc7",Nd:"#c7ffc7",ND:"#c7ffc7",Pm:"#a3ffc7",PM:"#a3ffc7",Sm:"#8fffc7",SM:"#8fffc7",Eu:"#61ffc7",EU:"#61ffc7",Gd:"#45ffc7",GD:"#45ffc7",Tb:"#30ffc7",TB:"#30ffc7",Dy:"#1fffc7",DY:"#1fffc7",Ho:"#00ff9c",HO:"#00ff9c",Er:"#00e675",ER:"#00e675",Tm:"#00d452",TM:"#00d452",Yb:"#00bf38",YB:"#00bf38",Lu:"#00ab24",LU:"#00ab24",Hf:"#4dc2ff",HF:"#4dc2ff",Ta:"#4da6ff",TA:"#4da6ff",W:"#2194d6",Re:"#267dab",RE:"#267dab",Os:"#266696",OS:"#266696",Ir:"#175487",IR:"#175487",Pt:"#d0d0e0",PT:"#d0d0e0",Au:"#ffd123",AU:"#ffd123",Hg:"#b8b8d0",HG:"#b8b8d0",Tl:"#a6544d",TL:"#a6544d",Pb:"#575961",PB:"#575961",Bi:"#9e4fb5",BI:"#9e4fb5",Po:"#ab5c00",PO:"#ab5c00",At:"#754f45",AT:"#754f45",Rn:"#428296",RN:"#428296",Fr:"#420066",FR:"#420066",Ra:"#007d00",RA:"#007d00",Ac:"#70abfa",AC:"#70abfa",Th:"#00baff",TH:"#00baff",Pa:"#00a1ff",PA:"#00a1ff",U:"#008fff",Np:"#0080ff",NP:"#0080ff",Pu:"#006bff",PU:"#006bff",Am:"#545cf2",AM:"#545cf2",Cm:"#785ce3",CM:"#785ce3",Bk:"#8a4fe3",BK:"#8a4fe3",Cf:"#a136d4",CF:"#a136d4",Es:"#b31fd4",ES:"#b31fd4",Fm:"#b31fba",FM:"#b31fba",Md:"#b30da6",MD:"#b30da6",No:"#bd0d87",NO:"#bd0d87",Lr:"#c70066",LR:"#c70066",Rf:"#cc0059",RF:"#cc0059",Db:"#d1004f",DB:"#d1004f",Sg:"#d90045",SG:"#d90045",Bh:"#e00038",BH:"#e00038",Hs:"#e6002e",HS:"#e6002e",Mt:"#eb0026",MT:"#eb0026"}};var V,ie,ne,ue,z,oe,ce;class ve{constructor(r,u,d){K(this,V);K(this,ie);c(this,"count");c(this,"instances");K(this,ne);K(this,ue);K(this,z);K(this,oe);K(this,ce,new Ue({viewProjectionMatrix:"mat4"},"InstancedSceneObject Camera Uniform Buffer"));Z(this,V,r),Z(this,ie,u),this.count=d,this.instances=[];for(let m=0;m<d;m++)this.instances.push(new Ye);Z(this,oe,new Float32Array(this.count*16))}getInstance(r){return this.instances[r]}async load(r){const{shaderModule:u,uniformBuffer:d}=v(this,ie).load(r);v(this,V).load(r);const m=this.count*16*4;Z(this,z,r.createBuffer({label:"Model Matrix Vertex Buffer",size:m,usage:GPUBufferUsage.VERTEX|GPUBufferUsage.COPY_DST})),r.queue.writeBuffer(v(this,z),0,v(this,oe)),Z(this,ne,await r.createRenderPipelineAsync({label:"InstancedSceneObject Render Pipeline",layout:"auto",vertex:{module:u,buffers:[{arrayStride:4*3,attributes:[{shaderLocation:0,offset:0,format:"float32x3"}]},{stepMode:"instance",arrayStride:16*4,attributes:[{shaderLocation:10,offset:0,format:"float32x4"},{shaderLocation:11,offset:16,format:"float32x4"},{shaderLocation:12,offset:16*2,format:"float32x4"},{shaderLocation:13,offset:16*3,format:"float32x4"}]}]},fragment:{module:u,targets:[{format:navigator.gpu.getPreferredCanvasFormat()}]},primitive:{topology:"triangle-list",cullMode:"back"},depthStencil:{depthWriteEnabled:!0,depthCompare:"less",format:"depth24plus"}}));const l=[{binding:0,resource:{buffer:v(this,ce).load(r)}}];d!=null&&d.buffer&&l.push({binding:1,resource:{buffer:d.buffer}}),Z(this,ue,r.createBindGroup({label:"Uniform Bind Group",layout:v(this,ne).getBindGroupLayout(0),entries:l}))}update(r,u){if(v(this,ce)&&(v(this,ce).set({viewProjectionMatrix:u}),v(this,ce).write(r)),v(this,z)){for(let d=0;d<this.instances.length;d++){const l=this.instances[d].modelMatrix;v(this,oe).set(l,d*16)}r.queue.writeBuffer(v(this,z),0,v(this,oe))}}render(r){if(!v(this,ne)||!v(this,V).indexBuffer)throw new Error("SceneObject not loaded");if(this.count===0){console.warn("InstancedSceneObject count is 0, skipping render");return}r.setPipeline(v(this,ne)),r.setBindGroup(0,v(this,ue)),r.setVertexBuffer(0,v(this,V).vertexBuffer),r.setVertexBuffer(1,v(this,z)),r.setIndexBuffer(v(this,V).indexBuffer,"uint32"),r.drawIndexed(v(this,V).indices.length,this.count)}}V=new WeakMap,ie=new WeakMap,ne=new WeakMap,ue=new WeakMap,z=new WeakMap,oe=new WeakMap,ce=new WeakMap;function ct(t){const r=t.coordinate.atoms,u=t.coordinate.hetatms,d=[...r,...u].sort((a,i)=>a.data.serial-i.data.serial),m=[];for(const a of d)if(a.data&&a.data.x!==null&&a.data.y!==null&&a.data.z!==null){const{x:i,y:P,z:n,element:e}=a.data,f=e?Re.Jmol[e]:Re.defaultColor;m.push({color:f,position:G.create(i,P,n)})}const l=[];for(let a=0;a<t.connectivity.conects.length-1;a++){const i=t.connectivity.conects[a],P=m[i.atomSeqNum-1];P||console.error("primaryAtom not found or invalid",i.atomSeqNum);for(const n of i.bondedAtomSeqNums){const e=m[n-1];if(!e){console.error("secondaryAtom not found or invalid",n);continue}l.push({start:P,end:e})}}const o=G.create();for(const a of m)o[0]+=a.position[0],o[1]+=a.position[1],o[2]+=a.position[2];o[0]/=m.length,o[1]/=m.length,o[2]/=m.length;for(const a of m)a.position=G.sub(a.position,o);return console.log("atoms",m.length,"bonds",l.length),{atoms:m,bonds:l}}function it(t,r=.15){const u=new Xe({radius:r}),d=new Ve({radiusTop:r,radiusBottom:r,height:1}),m=et(),l=new Map;t.atoms.forEach(i=>{const P=l.get(i.color);P?P.push(i):l.set(i.color,[i])});const o=[...l].map(([i,P])=>{const n=m.get(i),e=new ve(u,n,P.length);for(let f=0;f<P.length;f++){const{position:h}=P[f];e.getInstance(f).setPosition(G.create(...h))}return e}),a=new ve(d,m.get("#ccc"),t.bonds.length);for(let i=0;i<t.bonds.length;i++){const{start:P,end:n}=t.bonds[i],e=G.subtract(n.position,P.position),f=G.length(e),h=a.getInstance(i),p=G.create(0,1,0),b=G.divScalar(e,f),x=G.dot(p,b),I=Math.acos(x),C=G.cross(p,b);h.setRotation(180*I/Math.PI,C),h.translate(G.divScalar(G.add(P.position,n.position),2)),h.scaleY(f)}return{atoms:o,bonds:a}}function et(){const t=new Map;return{get:r=>{let u=t.get(r);return u||(u=new Ke(r,{instanced:!0}),t.set(r,u)),u}}}function ut(t){const r=Me(),u=r.addControl({name:"Molecule",type:"select",value:"example",options:[...Je.map(l=>({label:l==="example"?"Example":l.toUpperCase(),value:l}))]}),d=r.addControl({name:"Show molecule surface",type:"checkbox",value:!0}),m=r.addControl({name:"Show molecule structure",type:"checkbox",value:!0});return m.onChange(l=>t==null?void 0:t.updateBufferValues({molecularStructure:l?1:0})),{molecule:u,showMoleculeSurface:d,showMoleculeStructure:m}}function dt(t,r){const u=Me(),d="Camera",m=u.addControl({name:"Field of view",group:d,type:"range",value:t.fov,min:0,max:180});m.onChange(P=>t.fov=P);const l=u.addControl({name:"Near",group:d,type:"range",value:t.near,min:0,max:1,step:.01});l.onChange(P=>{t.near=P,r==null||r.updateBufferValues({near:P})});const o=u.addControl({name:"Far",group:d,type:"range",value:t.far,min:0,max:1e4});o.onChange(P=>{t.far=P,r==null||r.updateBufferValues({far:P})});const a=u.addControl({name:"Friction coefficient",group:d,type:"range",value:.01,min:0,max:.1,step:.001});a.onChange(P=>{de.contols&&(de.contols.frictionCoefficient=P)});const i=u.addControl({name:"Distance",group:d,type:"range",value:80,min:0,max:400});return i.onChange(P=>{de.contols&&(de.contols.distance=P)}),{fov:m,near:l,far:o,frictionCoefficient:a,distance:i}}export{ut as a,dt as b,it as c,ot as l,ct as p};
